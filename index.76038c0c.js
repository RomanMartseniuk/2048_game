const t=new class{initState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];score=0;status="idle";constructor(t){t&&(this.state=JSON.parse(JSON.stringify(t)),this.initState=JSON.parse(JSON.stringify(t)))}moveLeft(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);this.state.forEach(t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);for(let s=0;s<t.length;s++)t[s]=e[s]}),JSON.stringify(this.state)!==t&&this.spawnNewNum(),this.checkForWin(),this.checkForLose()}moveRight(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);this.state.forEach(t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.unshift(0);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t-1]=0);for(e=e.filter(t=>0!==t);e.length<4;)e.unshift(0);for(let s=0;s<t.length;s++)t[s]=e[s]}),JSON.stringify(this.state)!==t&&this.spawnNewNum(),this.checkForWin(),this.checkForLose()}moveUp(){if("playing"!==this.status)return;let t=JSON.stringify(this.state),e=this.state[0].map((t,e)=>this.state.map(t=>t[e]));e.forEach(t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);for(let s=0;s<t.length;s++)t[s]=e[s]}),this.state=e[0].map((t,s)=>e.map(t=>t[s])),JSON.stringify(this.state)!==t&&this.spawnNewNum(),this.checkForWin(),this.checkForLose()}moveDown(){if("playing"!==this.status)return;let t=JSON.stringify(this.state),e=this.state[0].map((t,e)=>this.state.map(t=>t[e]));e.forEach(t=>{let e=t.filter(t=>0!==t);for(;e.length<4;)e.unshift(0);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t-1]=0);for(e=e.filter(t=>0!==t);e.length<4;)e.unshift(0);for(let s=0;s<t.length;s++)t[s]=e[s]}),this.state=e[0].map((t,s)=>e.map(t=>t[s])),JSON.stringify(this.state)!==t&&this.spawnNewNum(),this.checkForWin(),this.checkForLose()}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.spawnNewNum(),this.spawnNewNum(),this.checkForLose()}restart(){this.clearTable(),this.score=0,this.status="idle"}spawnNewNum(){if(!this.checkEmptyCells())return;let[t,e]=this.getRandomEmptyCell();if(0!==this.state[t][e])return this.spawnNewNum();this.state[t][e]=10===Math.floor(11*Math.random())?4:2}getRandomEmptyCell(){return[Math.floor(4*Math.random()),Math.floor(4*Math.random())]}checkEmptyCells(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e])return!0;return!1}clearTable(){this.state=JSON.parse(JSON.stringify(this.initState))}checkForWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.state[t][e]){this.status="win",this.handleWin();return}}checkForLose(){this.checkEmptyCells()||this.checkMovesAvailable()||(this.status="lose",this.handleLoss())}checkMovesAvailable(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e]||t<3&&this.state[t][e]===this.state[t+1][e]||e<3&&this.state[t][e]===this.state[t][e+1])return!0;return!1}handleLoss(){let t=new Event("gameLost");document.dispatchEvent(t)}handleWin(){let t=new Event("gameWin");document.dispatchEvent(t)}},e=document.querySelector(".game-score");document.getElementById("start-button").onclick=()=>{t.start(),i(t.getState()),document.getElementById("start-button").classList.add("hidden"),document.getElementById("restart-button").classList.remove("hidden"),document.querySelector(".message-start").classList.add("hidden")},document.getElementById("restart-button").onclick=()=>{t.restart(),i(t.getState()),e.innerText=t.getScore(),document.getElementById("start-button").classList.remove("hidden"),document.getElementById("restart-button").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")};const s=document.querySelector(".game-field");function i(t){for(let e=0;e<4;e++)for(let i=0;i<4;i++)0===t[e][i]?(s.rows[e].cells[i].className="field-cell",s.rows[e].cells[i].innerText=""):(s.rows[e].cells[i].className=`field-cell field-cell--${t[e][i]}`,s.rows[e].cells[i].innerText=t[e][i])}function r(){"win"===t.getState()&&document.querySelector(".message-win").classList.remove("hidden"),"lose"===t.getState()&&document.querySelector(".message-lose").classList.remove("hidden")}document.addEventListener("keydown",s=>{if("playing"===t.getStatus()){switch(s.key){case"a":case"ArrowLeft":t.moveLeft(),r();break;case"d":case"ArrowRight":t.moveRight(),r();break;case"w":case"ArrowUp":t.moveUp(),r();break;case"s":case"ArrowDown":t.moveDown(),r()}i(t.getState()),e.innerText=t.getScore()}}),document.addEventListener("gameLost",()=>{document.querySelector(".message-lose").classList.remove("hidden")}),document.addEventListener("gameWin",()=>{document.querySelector(".message-win").classList.remove("hidden")});
//# sourceMappingURL=index.76038c0c.js.map
